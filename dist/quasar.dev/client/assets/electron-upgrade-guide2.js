import{b as m,d as f,w as s,h as n,f as a,e as t,k as i,i as e}from"./vendor.js";import{c as l}from"./_examples_frameless-electron-window.js";import{D as g,a as u}from"./DocPage.js";import{D as k}from"./DocTree.js";import{D as p}from"./DocPrerender.js";import{C as c}from"./CopyButton.js";import{_ as w}from"./index.js";const y=n("p",null,"When you add the Electron mode in a Quasar project for the first time you will get the latest version of the Electron package. At some point in time, you will want to upgrade the Electron version.",-1),b=n("p",null,"Before upgrading Electron, please consult its release notes. Are there breaking changes?",-1),v=n("pre",{class:"doc-code"},[n("code",null,[n("span",{class:"token comment"},"# from the root of your Quasar project"),e(`
$ `),n("span",{class:"token function"},"yarn"),e(" upgrade electron@latest")])],-1),_=n("pre",{class:"doc-code"},[n("code",null,[n("span",{class:"token comment"},"# from the root of your Quasar project"),e(`
$ `),n("span",{class:"token function"},"npm"),e(),n("span",{class:"token function"},"install"),e(" electron@latest")])],-1),j=n("pre",{class:"doc-code"},[n("code",null,[n("span",{class:"token comment"},"# from the root of your Quasar project"),e(`
$ `),n("span",{class:"token function"},"pnpm"),e(),n("span",{class:"token function"},"add"),e(" electron@latest")])],-1),N=n("pre",{class:"doc-code"},[n("code",null,[n("span",{class:"token comment"},"# from the root of your Quasar project"),e(`
$ bun `),n("span",{class:"token function"},"add"),e(" electron@latest")])],-1),W=n("p",null,"The Electron mode for Quasar v2 is an almost complete overhaul of the previous version, significantly improving the developer experience. Some of the changes here are required in order to ensure compatibility with the latest developments in the Electron world (so bulletproofing for upcoming upstream changes).",-1),x=n("ul",null,[n("li",null,[n("strong",null,"Out of the box support for Typescript"),e(". Just rename electron-main.js and electron-preload.js to electron-main.ts and electron-preload.ts.")]),n("li",null,[e("Support for Electron 11 and preparing out of the box support for upcoming changes in Electron 12+ (without you needing to change anything in the future). One of changes are that we’ll be using "),n("code",{class:"doc-token"},"contextIsolation"),e(" instead of the deprecated "),n("code",{class:"doc-token"},"Node Integration"),e(".")]),n("li",null,[e("The preload script no longer has the old limitations. You can import other js files with a relative path because the script is now bundled and passed through Babel (so you can use the "),n("code",{class:"doc-token"},"import X from Y"),e(" syntax too). You can also enable linting for it.")]),n("li",null,"You can enable linting for the main thread and the preload script too."),n("li",null,"We’ve removed the default electron-main.dev.js support as it seems that it’s not needed anymore. However, you can add it back by creating it and referencing it from electron-main (it’s no longer detected by Quasar CLI automatically – because we don’t need to; more on this later).")],-1),E=n("p",null,[e("The "),n("strong",null,"old"),e(" structure was:")],-1),I=n("p",null,[e("The "),n("strong",null,"NEW"),e(" structure is:")],-1),T=n("p",null,[e("Notice that there’s no "),n("code",{class:"doc-token"},"electron-main.dev.js"),e(" file anymore (not needed anymore) and that the "),n("code",{class:"doc-token"},"electron-preload/main.js"),e(" files need to be moved directly under "),n("code",{class:"doc-token"},"/src-electron"),e(".")],-1),q=n("p",null,"In order for us to be forward compatible with future versions of Electron, you’ll need to do some small (but important!) changes:",-1),D=n("pre",{class:"doc-code"},[n("code",null,[e("mainWindow "),n("span",{class:"token operator"},"="),e(),n("span",{class:"token keyword"},"new"),e(),n("span",{class:"token class-name"},"BrowserWindow"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),e(`
  `),n("span",{class:"token comment"},"// ..."),e(`
  `),n("span",{class:"token literal-property property"},"webPreferences"),n("span",{class:"token operator"},":"),e(),n("span",{class:"token punctuation"},"{"),e(`
    `),n("span",{class:"token literal-property property"},"nodeIntegration"),n("span",{class:"token operator"},":"),e(" process"),n("span",{class:"token punctuation"},"."),e("env"),n("span",{class:"token punctuation"},"."),n("span",{class:"token constant"},"QUASAR_NODE_INTEGRATION"),n("span",{class:"token punctuation"},","),e(`
    `),n("span",{class:"token literal-property property"},"nodeIntegrationInWorker"),n("span",{class:"token operator"},":"),e(" process"),n("span",{class:"token punctuation"},"."),e("env"),n("span",{class:"token punctuation"},"."),n("span",{class:"token constant"},"QUASAR_NODE_INTEGRATION"),n("span",{class:"token punctuation"},","),e(`
    `),n("span",{class:"token comment"},"// preload: path.resolve(__dirname, 'electron-preload.js')"),e(`
  `),n("span",{class:"token punctuation"},"}"),e(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")")])],-1),P=n("pre",{class:"doc-code"},[n("code",null,[e("mainWindow "),n("span",{class:"token operator"},"="),e(),n("span",{class:"token keyword"},"new"),e(),n("span",{class:"token class-name"},"BrowserWindow"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),e(`
  `),n("span",{class:"token comment"},"// ..."),e(`
  `),n("span",{class:"token literal-property property"},"webPreferences"),n("span",{class:"token operator"},":"),e(),n("span",{class:"token punctuation"},"{"),e(`
    `),n("span",{class:"token comment"},"// we enable contextIsolation (Electron 12+ has it enabled by default anyway)"),e(`
    `),n("span",{class:"token literal-property property"},"contextIsolation"),n("span",{class:"token operator"},":"),e(),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},","),e(`
    `),n("span",{class:"token comment"},"// we use a new way to reference the preload script"),e(`
    `),n("span",{class:"token comment"},"// (it's going to be needed, so add it and create the file if it's not there already)"),e(`
    `),n("span",{class:"token literal-property property"},"preload"),n("span",{class:"token operator"},":"),e(" path"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"resolve"),n("span",{class:"token punctuation"},"("),e("__dirname"),n("span",{class:"token punctuation"},","),e(" process"),n("span",{class:"token punctuation"},"."),e("env"),n("span",{class:"token punctuation"},"."),n("span",{class:"token constant"},"QUASAR_ELECTRON_PRELOAD"),n("span",{class:"token punctuation"},")"),e(`
  `),n("span",{class:"token punctuation"},"}"),e(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")")])],-1),A=n("p",null,"You will need this file if you don’t have it already. So create it if it’s missing. Without it you won’t be able to use the power of Node.js in your renderer thread.",-1),B=n("div",{class:"doc-note doc-note--danger"},[n("p",{class:"doc-note__title"},"WARNING"),n("p",null,[e("You will need to transfer all the Node.js stuff away from your renderer thread (the UI code from /src) and into the preload script. Provide the same functionality through the "),n("code",{class:"doc-token"},"contextBridge"),e(" as seen below.")])],-1),C=n("p",null,[e("This is the default content of "),n("code",{class:"doc-token"},"electron-preload.js"),e(":")],-1),M=n("pre",{class:"doc-code"},[n("code",null,[n("span",{class:"token comment"},`/**
 * This file is used specifically for security reasons.
 * Here you can access Nodejs stuff and inject functionality into
 * the renderer thread (accessible there through the "window" object)
 *
 * WARNING!
 * If you import anything from node_modules, then make sure that the package is specified
 * in package.json > "dependencies" and NOT in "devDependencies"
 *
 * Example (injects window.myAPI.doAThing() into renderer thread):
 *
 *   const { contextBridge } = require('electron')
 *
 *   contextBridge.exposeInMainWorld('myAPI', {
 *     doAThing: () => {}
 *   })
 */`)])],-1),Q=n("pre",{class:"doc-code"},[n("code",null,[n("span",{class:"token literal-property property"},"electron"),n("span",{class:"token operator"},":"),e(),n("span",{class:"token punctuation"},"{"),e(`
  `),n("span",{class:"token comment"},"// it's gone now (upcoming upstream breaking change)"),e(`
  `),n("span",{class:"token comment"},"// replaced by a change in electron-main.js documented earlier"),e(`
  `),n("span",{class:"token literal-property property"},"nodeIntegration"),n("span",{class:"token operator"},":"),e(),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},","),e(),n("span",{class:"token comment"},"// remove me!"),e(`

  `),n("span",{class:"token comment"},"// renamed to chainWebpackMain"),e(`
  `),n("span",{class:"token function"},"chainWebpack"),e(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"chain"),n("span",{class:"token punctuation"},")"),e(),n("span",{class:"token punctuation"},"{"),e(),n("span",{class:"token comment"},"/* ... */"),e(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),e(`

  `),n("span",{class:"token comment"},"// renamed to extendWebpackMain"),e(`
  `),n("span",{class:"token function"},"extendWebpack"),e(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"cfg"),n("span",{class:"token punctuation"},")"),e(),n("span",{class:"token punctuation"},"{"),e(),n("span",{class:"token comment"},"/* ... */"),e(),n("span",{class:"token punctuation"},"}"),e(`
`),n("span",{class:"token punctuation"},"}")])],-1),S=n("pre",{class:"doc-code"},[n("code",null,[n("span",{class:"token literal-property property"},"electron"),n("span",{class:"token operator"},":"),e(),n("span",{class:"token punctuation"},"{"),e(`
  `),n("span",{class:"token comment"},"// was renamed from chainWebpack()"),e(`
  `),n("span",{class:"token function"},"chainWebpackMain"),e(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"chain"),n("span",{class:"token punctuation"},")"),e(),n("span",{class:"token punctuation"},"{"),e(`
    `),n("span",{class:"token comment"},"// example for its content (adds linting)"),e(`
    chain`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"plugin"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'eslint-webpack-plugin'"),n("span",{class:"token punctuation"},")"),e(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),e("ESLintPlugin"),n("span",{class:"token punctuation"},","),e(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"{"),e(),n("span",{class:"token literal-property property"},"extensions"),n("span",{class:"token operator"},":"),e(),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'js'"),n("span",{class:"token punctuation"},"]"),e(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),e(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),e(`

  `),n("span",{class:"token comment"},"// was renamed from extendWebpack()"),e(`
  `),n("span",{class:"token function"},"extendWebpackMain"),e(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"cfg"),n("span",{class:"token punctuation"},")"),e(),n("span",{class:"token punctuation"},"{"),e(),n("span",{class:"token comment"},"/* ... */"),e(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),e(`

  `),n("span",{class:"token comment"},"// New!"),e(`
  `),n("span",{class:"token function"},"chainWebpackPreload"),e(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"chain"),n("span",{class:"token punctuation"},")"),e(),n("span",{class:"token punctuation"},"{"),e(`
    `),n("span",{class:"token comment"},"// example (adds linting)"),e(`
    chain`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"plugin"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'eslint-webpack-plugin'"),n("span",{class:"token punctuation"},")"),e(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),e("ESLintPlugin"),n("span",{class:"token punctuation"},","),e(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"{"),e(),n("span",{class:"token literal-property property"},"extensions"),n("span",{class:"token operator"},":"),e(),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'js'"),n("span",{class:"token punctuation"},"]"),e(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),e(`
  `),n("span",{class:"token punctuation"},"}"),e(`

  `),n("span",{class:"token comment"},"// New!"),e(`
  `),n("span",{class:"token function"},"extendWebpackPreload"),e(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"cfg"),n("span",{class:"token punctuation"},")"),e(),n("span",{class:"token punctuation"},"{"),e(),n("span",{class:"token comment"},"/* ... */"),e(),n("span",{class:"token punctuation"},"}"),e(`
`),n("span",{class:"token punctuation"},"}")])],-1),U=n("code",{class:"doc-token"},"electron",-1),$=n("div",{class:"doc-note doc-note--danger"},[n("p",{class:"doc-note__title"},"WARNING"),n("p",null,[e("You will need to transfer all the Node.js stuff away from your renderer thread (the UI code from /src) and into the preload script. Provide the same functionality through the "),n("code",{class:"doc-token"},"contextBridge"),e(" as seen in the preload script section above.")])],-1),O=n("p",null,"You may also want the following code in your electron-main.js to auto-open devtools while on dev mode (or prod with debugging enabled) and to disable devtools on production builds (without debugging enabled):",-1),R=n("pre",{class:"doc-code"},[n("code",null,[n("span",{class:"token keyword"},"function"),e(),n("span",{class:"token function"},"createWindow"),e(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),e(),n("span",{class:"token punctuation"},"{"),e(`
  mainWindow `),n("span",{class:"token operator"},"="),e(),n("span",{class:"token keyword"},"new"),e(),n("span",{class:"token class-name"},"BrowserWindow"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),e(),n("span",{class:"token comment"},"/* ... */"),e(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),e(`

  `),n("span",{class:"token keyword"},"if"),e(),n("span",{class:"token punctuation"},"("),e("process"),n("span",{class:"token punctuation"},"."),e("env"),n("span",{class:"token punctuation"},"."),n("span",{class:"token constant"},"DEBUGGING"),n("span",{class:"token punctuation"},")"),e(),n("span",{class:"token punctuation"},"{"),e(`
    `),n("span",{class:"token comment"},"// if on DEV or Production with debug enabled"),e(`
    mainWindow`),n("span",{class:"token punctuation"},"."),e("webContents"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"openDevTools"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),e(`
  `),n("span",{class:"token punctuation"},"}"),e(`
  `),n("span",{class:"token keyword"},"else"),e(),n("span",{class:"token punctuation"},"{"),e(`
    `),n("span",{class:"token comment"},"// we're on production; no access to devtools pls"),e(`
    mainWindow`),n("span",{class:"token punctuation"},"."),e("webContents"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"on"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'devtools-opened'"),n("span",{class:"token punctuation"},","),e(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),e(),n("span",{class:"token operator"},"=>"),e(),n("span",{class:"token punctuation"},"{"),e(`
      mainWindow`),n("span",{class:"token punctuation"},"."),e("webContents"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"closeDevTools"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),e(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),e(`
  `),n("span",{class:"token punctuation"},"}"),e(`
`),n("span",{class:"token punctuation"},"}")])],-1),L={__name:"electron-upgrade-guide",setup(Y){const h=[{id:"upgrading-electron",title:"2. Upgrading Electron"},{id:"upgrading-from-quasar-v1",title:"3. Upgrading from Quasar v1"},{id:"high-overview-of-the-improvements",title:"3.1. High overview of the improvements",sub:!0},{id:"the-src-electron-folder",title:"3.2. The /src-electron folder",sub:!0},{id:"the-electron-main-js-file",title:"3.3. The electron-main.js file",sub:!0},{id:"the-electron-preload-js-file",title:"3.4. The electron-preload.js file",sub:!0},{id:"quasar-config-file-changes",title:"3.5. quasar.config file changes",sub:!0},{id:"renderer-thread-src-",title:"3.6. Renderer thread (/src)",sub:!0},{id:"browser-devtools",title:"3.7. Browser Devtools",sub:!0}],d={oldStructure:{l:"src-electron",c:[{l:"icons",e:"Icons of your app for all platforms",c:[{l:"icon.icns",e:"Icon file for Darwin (MacOS) platform"},{l:"icon.ico",e:"Icon file for win32 (Windows) platform"},{l:"linux-512x512.png",e:"Icon file for Linux platform (when using electron-builder)"}]},{l:"main-process",c:[{l:"electron-preload.js",e:"Electron preload script (injects Node.js stuff into renderer thread)"},{l:"electron-main.dev.js",e:"Main thread code (preceded by dev code only)"},{l:"electron-main.js",e:"Main thread code (production code)"}]}]},newStructure:{l:"src-electron",c:[{l:"icons",e:"Icons of your app for all platforms",c:[{l:"icon.icns",e:"Icon file for Darwin (MacOS) platform"},{l:"icon.ico",e:"Icon file for win32 (Windows) platform"},{l:"icon.png",e:"Tray icon file for all platforms (especially Linux)"}]},{l:"electron-preload.js",e:"(or .ts) Electron preload script (injects Node.js stuff into renderer thread)"},{l:"electron-main.js",e:"(or .ts) Main thread code"}]}};return(G,o)=>(m(),f(g,{title:"Upgrade guide on Electron",desc:"(@quasar/app-webpack) Upgrading instructions when dealing with Electron in Quasar.",overline:"Quasar CLI with Webpack - @quasar/app-webpack",heading:"","edit-link":"quasar-cli-webpack/developing-electron-apps/electron-upgrade-guide",toc:h},{default:s(()=>[n("h2",{id:"upgrading-electron",class:"doc-heading doc-h2",onClick:o[0]||(o[0]=r=>a(l)("upgrading-electron"))},"Upgrading Electron"),y,b,t(a(p),{tabs:["Yarn","NPM","PNPM","Bun"]},{default:s(()=>[t(i,{class:"q-pa-none",name:"Yarn"},{default:s(()=>[v,t(c,{lang:"bash"})]),_:1}),t(i,{class:"q-pa-none",name:"NPM"},{default:s(()=>[_,t(c,{lang:"bash"})]),_:1}),t(i,{class:"q-pa-none",name:"PNPM"},{default:s(()=>[j,t(c,{lang:"bash"})]),_:1}),t(i,{class:"q-pa-none",name:"Bun"},{default:s(()=>[N,t(c,{lang:"bash"})]),_:1})]),_:1}),n("h2",{id:"upgrading-from-quasar-v1",class:"doc-heading doc-h2",onClick:o[1]||(o[1]=r=>a(l)("upgrading-from-quasar-v1"))},"Upgrading from Quasar v1"),W,n("h3",{id:"high-overview-of-the-improvements",class:"doc-heading doc-h3",onClick:o[2]||(o[2]=r=>a(l)("high-overview-of-the-improvements"))},"High overview of the improvements"),x,n("h3",{id:"the-src-electron-folder",class:"doc-heading doc-h3",onClick:o[3]||(o[3]=r=>a(l)("the-src-electron-folder"))},"The /src-electron folder"),E,t(k,{def:d.oldStructure},null,8,["def"]),I,t(k,{def:d.newStructure},null,8,["def"]),T,n("h3",{id:"the-electron-main-js-file",class:"doc-heading doc-h3",onClick:o[4]||(o[4]=r=>a(l)("the-electron-main-js-file"))},"The electron-main.js file"),q,t(a(p),{title:"OLD way"},{default:s(()=>[D,t(c)]),_:1}),t(a(p),{title:"NEW way"},{default:s(()=>[P,t(c)]),_:1}),n("h3",{id:"the-electron-preload-js-file",class:"doc-heading doc-h3",onClick:o[5]||(o[5]=r=>a(l)("the-electron-preload-js-file"))},"The electron-preload.js file"),A,n("p",null,[e("More info: "),t(u,{to:"/quasar-cli-webpack/developing-electron-apps/electron-preload-script"},{default:s(()=>[e("preload script")]),_:1}),e(".")]),B,C,t(a(p),null,{default:s(()=>[M,t(c)]),_:1}),n("h3",{id:"quasar-config-file-changes",class:"doc-heading doc-h3",onClick:o[6]||(o[6]=r=>a(l)("quasar-config-file-changes"))},"quasar.config file changes"),t(a(p),{title:"OLD way"},{default:s(()=>[Q,t(c)]),_:1}),t(a(p),{title:"NEW way"},{default:s(()=>[S,t(c)]),_:1}),n("h3",{id:"renderer-thread-src-",class:"doc-heading doc-h3",onClick:o[7]||(o[7]=r=>a(l)("renderer-thread-src-"))},"Renderer thread (/src)"),n("p",null,[e("The "),t(u,{to:"/options/the-q-object"},{default:s(()=>[e("$q object")]),_:1}),e(" no longer contains the "),U,e(" property. You will need to use the "),t(u,{to:"/quasar-cli-webpack/developing-electron-apps/electron-preload-script"},{default:s(()=>[e("preload script")]),_:1}),e(" to access it and provide it to the renderer thread.")]),n("p",null,[e("Furthermore, the "),t(u,{to:"/quasar-utils/other-utils#open-external-url"},{default:s(()=>[e("openURL")]),_:1}),e(" util can no longer tap into Electron to open a new window. You will need to provide your own util from the preload script.")]),$,n("h3",{id:"browser-devtools",class:"doc-heading doc-h3",onClick:o[8]||(o[8]=r=>a(l)("browser-devtools"))},"Browser Devtools"),O,t(a(p),null,{default:s(()=>[R,t(c)]),_:1})]),_:1}))}},Z=w(L,[["__file","electron-upgrade-guide.md"]]);export{Z as default};
