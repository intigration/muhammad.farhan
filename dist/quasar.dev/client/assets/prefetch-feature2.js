import{b as h,d as m,w as o,h as n,f as a,e as s,l as f,i as t,k as r}from"./vendor.js";import{c as l}from"./_examples_frameless-electron-window.js";import{D as g,a as i}from"./DocPage.js";import{D as p}from"./DocPrerender.js";import{C as c}from"./CopyButton.js";import{_ as y}from"./index.js";const w=n("p",null,[t("The PreFetch is a feature ("),n("strong",null,"only available when using Quasar CLI"),t(") which allows the components picked up by Vue Router (defined in "),n("code",{class:"doc-token"},"/src/router/routes.js"),t(") to:")],-1),v=n("ul",null,[n("li",null,"pre-fetch data"),n("li",null,"validate the route"),n("li",null,"redirect to another route, when some conditions aren’t met (like user isn’t logged in)"),n("li",null,"can help in initializing the Store state")],-1),_=n("p",null,"All the above will run before the actual route component is rendered.",-1),b=n("p",null,[n("strong",null,"It is designed to work with all Quasar modes"),t(" (SPA, PWA, SSR, Cordova, Electron), but it is especially useful for SSR builds.")],-1),S=n("pre",{class:"doc-code"},[n("code",null,[n("span",{class:"token keyword"},"return"),t(),n("span",{class:"token punctuation"},"{"),t(`
  `),n("span",{class:"token literal-property property"},"preFetch"),n("span",{class:"token operator"},":"),t(),n("span",{class:"token boolean"},"true"),t(`
`),n("span",{class:"token punctuation"},"}")])],-1),x=n("div",{class:"doc-note doc-note--warning"},[n("p",{class:"doc-note__title"},"WARNING"),n("p",null,[t("When you use it to pre-fetch data, you are required to use a Vuex Store, so make sure that your project folder has the "),n("code",{class:"doc-token"},"/src/store"),t(" folder when you create your project, otherwise generate a new project and copy the store folder contents to your current project.")])],-1),P=n("p",null,[t("This feature is especially useful for the SSR mode (but not limited to it only). During SSR, we are essentially rendering a “snapshot” of our app, so if the app relies on some asynchronous data, "),n("strong",null,"then this data needs to be pre-fetched and resolved before we start the rendering process"),t(".")],-1),F=n("p",null,"Another concern is that on the client, the same data needs to be available before we mount the client side app - otherwise the client app would render using a different state and the hydration would fail.",-1),C=n("p",null,"To address this, the fetched data needs to live outside the view components, in a dedicated data store, or a “state container”. On the server, we can pre-fetch and fill data into the store before rendering. The client-side store will directly pick up the server state before we mount the app.",-1),L=n("p",null,[t("The "),n("code",{class:"doc-token"},"preFetch"),t(" hook (described in next sections) is determined by the route visited - which also determines what components are rendered. In fact, the data needed for a given route is also the data needed by the components rendered at that route. "),n("strong",null,"So it is natural (and also required) to place the hook logic ONLY inside route components."),t(" This includes "),n("code",{class:"doc-token"},"/src/App.vue"),t(", which in this case will run only once at the app bootup.")],-1),I=n("p",null,[t("Let’s take an example in order to understand when the hook is being called. Let’s say we have these routes and we’ve written "),n("code",{class:"doc-token"},"preFetch"),t(" hooks for all these components:")],-1),R=n("pre",{class:"doc-code"},[n("code",null,[n("span",{class:"token punctuation"},"["),t(`
  `),n("span",{class:"token punctuation"},"{"),t(`
    `),n("span",{class:"token literal-property property"},"path"),n("span",{class:"token operator"},":"),t(),n("span",{class:"token string"},"'/'"),n("span",{class:"token punctuation"},","),t(`
    `),n("span",{class:"token literal-property property"},"component"),n("span",{class:"token operator"},":"),t(` LandingPage
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),t(`
  `),n("span",{class:"token punctuation"},"{"),t(`
    `),n("span",{class:"token literal-property property"},"path"),n("span",{class:"token operator"},":"),t(),n("span",{class:"token string"},"'/shop'"),n("span",{class:"token punctuation"},","),t(`
    `),n("span",{class:"token literal-property property"},"component"),n("span",{class:"token operator"},":"),t(" ShopLayout"),n("span",{class:"token punctuation"},","),t(`
    `),n("span",{class:"token literal-property property"},"children"),n("span",{class:"token operator"},":"),t(),n("span",{class:"token punctuation"},"["),t(`
      `),n("span",{class:"token punctuation"},"{"),t(`
        `),n("span",{class:"token literal-property property"},"path"),n("span",{class:"token operator"},":"),t(),n("span",{class:"token string"},"'all'"),n("span",{class:"token punctuation"},","),t(`
        `),n("span",{class:"token literal-property property"},"component"),n("span",{class:"token operator"},":"),t(` ShopAll
      `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),t(`
      `),n("span",{class:"token punctuation"},"{"),t(`
        `),n("span",{class:"token literal-property property"},"path"),n("span",{class:"token operator"},":"),t(),n("span",{class:"token string"},"'new'"),n("span",{class:"token punctuation"},","),t(`
        `),n("span",{class:"token literal-property property"},"component"),n("span",{class:"token operator"},":"),t(` ShopNew
      `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),t(`
      `),n("span",{class:"token punctuation"},"{"),t(`
        `),n("span",{class:"token literal-property property"},"path"),n("span",{class:"token operator"},":"),t(),n("span",{class:"token string"},"'product/:name'"),n("span",{class:"token punctuation"},","),t(`
        `),n("span",{class:"token literal-property property"},"component"),n("span",{class:"token operator"},":"),t(" ShopProduct"),n("span",{class:"token punctuation"},","),t(`
        `),n("span",{class:"token literal-property property"},"children"),n("span",{class:"token operator"},":"),t(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"{"),t(`
          `),n("span",{class:"token literal-property property"},"path"),n("span",{class:"token operator"},":"),t(),n("span",{class:"token string"},"'overview'"),n("span",{class:"token punctuation"},","),t(`
          `),n("span",{class:"token literal-property property"},"component"),n("span",{class:"token operator"},":"),t(` ShopProductOverview
        `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"]"),t(`
      `),n("span",{class:"token punctuation"},"}"),t(`
    `),n("span",{class:"token punctuation"},"]"),t(`
  `),n("span",{class:"token punctuation"},"}"),t(`
`),n("span",{class:"token punctuation"},"]")])],-1),T=n("p",null,"Now, let’s see how the hooks are called when the user visits these routes in the order specified below, one after another.",-1),A=n("thead",null,[n("tr",null,[n("th",{class:"text-left"},"Route being visited"),n("th",{class:"text-left"},"Hooks called from"),n("th",{class:"text-left"},"Observations")])],-1),N=n("tbody",null,[n("tr",null,[n("td",null,[n("code",{class:"doc-token"},"/")]),n("td",null,"App.vue then LandingPage"),n("td",null,"App.vue hook is called since our app boots up.")]),n("tr",null,[n("td",null,[n("code",{class:"doc-token"},"/shop/all")]),n("td",null,"ShopLayout then ShopAll"),n("td",null,"-")]),n("tr",null,[n("td",null,[n("code",{class:"doc-token"},"/shop/new")]),n("td",null,"ShopNew"),n("td",null,"ShopNew is a child of ShopLayout, and ShopLayout is already rendered, so ShopLayout isn’t called again.")]),n("tr",null,[n("td",null,[n("code",{class:"doc-token"},"/shop/product/pyjamas")]),n("td",null,"ShopProduct"),n("td",null,"-")]),n("tr",null,[n("td",null,[n("code",{class:"doc-token"},"/shop/product/shoes")]),n("td",null,"ShopProduct"),n("td",null,"Quasar notices the same component is already rendered, but the route has been updated and it has route params, so it calls the hook again.")]),n("tr",null,[n("td",null,[n("code",{class:"doc-token"},"/shop/product/shoes/overview")]),n("td",null,"ShopProduct then ShopProductOverview"),n("td",null,"ShopProduct has route params so it is called even though it’s already rendered.")]),n("tr",null,[n("td",null,[n("code",{class:"doc-token"},"/")]),n("td",null,"LandingPage"),n("td",null,"-")])],-1),j=n("p",null,[t("The hook is defined as a custom static function called "),n("code",{class:"doc-token"},"preFetch"),t(" on our route components. Note that because this function will be called before the components are instantiated, it doesn’t have access to "),n("code",{class:"doc-token"},"this"),t(".")],-1),M=n("pre",{class:"doc-code"},[n("code",null,[n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),t("template")]),n("span",{class:"token punctuation"},">")]),t(`
  `),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),t("div")]),n("span",{class:"token punctuation"},">")]),t("{{ item.title }}"),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),t("div")]),n("span",{class:"token punctuation"},">")]),t(`
`),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),t("template")]),n("span",{class:"token punctuation"},">")]),t(`

`),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),t("script")]),n("span",{class:"token punctuation"},">")]),n("span",{class:"token script"},[n("span",{class:"token language-javascript"},[t(`
`),n("span",{class:"token keyword"},"import"),t(),n("span",{class:"token punctuation"},"{"),t(" useStore "),n("span",{class:"token punctuation"},"}"),t(),n("span",{class:"token keyword"},"from"),t(),n("span",{class:"token string"},"'vuex'"),t(`

`),n("span",{class:"token keyword"},"export"),t(),n("span",{class:"token keyword"},"default"),t(),n("span",{class:"token punctuation"},"{"),t(`
  `),n("span",{class:"token comment"},"// our hook here"),t(`
  `),n("span",{class:"token function"},"preFetch"),t(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[n("span",{class:"token punctuation"},"{"),t(" store"),n("span",{class:"token punctuation"},","),t(" currentRoute"),n("span",{class:"token punctuation"},","),t(" previousRoute"),n("span",{class:"token punctuation"},","),t(" redirect"),n("span",{class:"token punctuation"},","),t(" ssrContext"),n("span",{class:"token punctuation"},","),t(" urlPath"),n("span",{class:"token punctuation"},","),t(" publicPath "),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token punctuation"},"{"),t(`
    `),n("span",{class:"token comment"},"// fetch data, validate route and optionally redirect to some other route..."),t(`

    `),n("span",{class:"token comment"},"// ssrContext is available only server-side in SSR mode"),t(`

    `),n("span",{class:"token comment"},'// No access to "this" here'),t(`

    `),n("span",{class:"token comment"},"// Return a Promise if you are running an async job"),t(`
    `),n("span",{class:"token comment"},"// Example:"),t(`
    `),n("span",{class:"token keyword"},"return"),t(" store"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"dispatch"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'fetchItem'"),n("span",{class:"token punctuation"},","),t(" currentRoute"),n("span",{class:"token punctuation"},"."),t("params"),n("span",{class:"token punctuation"},"."),t("id"),n("span",{class:"token punctuation"},")"),t(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),t(`

  `),n("span",{class:"token function"},"setup"),t(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token punctuation"},"{"),t(`
    `),n("span",{class:"token keyword"},"const"),t(" $store "),n("span",{class:"token operator"},"="),t(),n("span",{class:"token function"},"useStore"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),t(`

    `),n("span",{class:"token comment"},"// display the item from store state."),t(`
    `),n("span",{class:"token keyword"},"const"),t(" item "),n("span",{class:"token operator"},"="),t(),n("span",{class:"token function"},"computed"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token operator"},"=>"),t(" $store"),n("span",{class:"token punctuation"},"."),t("state"),n("span",{class:"token punctuation"},"."),t("items"),n("span",{class:"token punctuation"},"["),n("span",{class:"token keyword"},"this"),n("span",{class:"token punctuation"},"."),t("$route"),n("span",{class:"token punctuation"},"."),t("params"),n("span",{class:"token punctuation"},"."),t("id"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),t(`

    `),n("span",{class:"token keyword"},"return"),t(),n("span",{class:"token punctuation"},"{"),t(" item "),n("span",{class:"token punctuation"},"}"),t(`
  `),n("span",{class:"token punctuation"},"}"),t(`
`),n("span",{class:"token punctuation"},"}"),t(`
`)])]),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),t("script")]),n("span",{class:"token punctuation"},">")])])],-1),V=n("p",null,[t("If you are using "),n("code",{class:"doc-token"},"<script setup>"),t(" (and Vue 3.3+):")],-1),$=n("pre",{class:"doc-code"},[n("code",null,[n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),t("script")]),t(),n("span",{class:"token attr-name"},"setup"),n("span",{class:"token punctuation"},">")]),n("span",{class:"token script"},[n("span",{class:"token language-javascript"},[t(`
`),n("span",{class:"token comment"},`/**
 * The defineOptions is a macro.
 * The options will be hoisted to module scope and cannot access local
 * variables in <script setup> that are not literal constants.
 */`),t(`
`),n("span",{class:"token function"},"defineOptions"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),t(`
  `),n("span",{class:"token function"},"preFetch"),t(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token punctuation"},"{"),t(`
    console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'running preFetch'"),n("span",{class:"token punctuation"},")"),t(`
  `),n("span",{class:"token punctuation"},"}"),t(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),t(`
`)])]),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),t("script")]),n("span",{class:"token punctuation"},">")])])],-1),q={class:"doc-note doc-note--tip"},Q=n("p",{class:"doc-note__title"},"TIP",-1),O=n("pre",{class:"doc-code"},[n("code",null,[n("span",{class:"token comment"},"// related action for Promise example"),t(`
`),n("span",{class:"token comment"},"// ..."),t(`

`),n("span",{class:"token literal-property property"},"actions"),n("span",{class:"token operator"},":"),t(),n("span",{class:"token punctuation"},"{"),t(`
  `),n("span",{class:"token function"},"fetchItem"),t(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[n("span",{class:"token punctuation"},"{"),t(" commit "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),t(" id")]),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token punctuation"},"{"),t(`
    `),n("span",{class:"token keyword"},"return"),t(" axiosInstance"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),t("url"),n("span",{class:"token punctuation"},","),t(" id"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"then"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[n("span",{class:"token punctuation"},"{"),t(" data "),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token operator"},"=>"),t(),n("span",{class:"token punctuation"},"{"),t(`
      `),n("span",{class:"token function"},"commit"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'mutation'"),n("span",{class:"token punctuation"},","),t(" data"),n("span",{class:"token punctuation"},")"),t(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),t(`
  `),n("span",{class:"token punctuation"},"}"),t(`
`),n("span",{class:"token punctuation"},"}"),t(`

`),n("span",{class:"token comment"},"// ...")])],-1),z=n("p",null,"Below is an example of redirecting the user under some circumstances, like when they try to access a page that only an authenticated user should see.",-1),W=n("pre",{class:"doc-code"},[n("code",null,[n("span",{class:"token comment"},"// We assume here we already wrote the authentication logic"),t(`
`),n("span",{class:"token comment"},"// in the Vuex Store, so take as a high-level example only."),t(`
`),n("span",{class:"token function"},"preFetch"),t(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[n("span",{class:"token punctuation"},"{"),t(" store"),n("span",{class:"token punctuation"},","),t(" redirect "),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token punctuation"},"{"),t(`
  `),n("span",{class:"token keyword"},"if"),t(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),t("store"),n("span",{class:"token punctuation"},"."),t("state"),n("span",{class:"token punctuation"},"."),t("authenticated"),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token punctuation"},"{"),t(`
    `),n("span",{class:"token function"},"redirect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),t(),n("span",{class:"token literal-property property"},"path"),n("span",{class:"token operator"},":"),t(),n("span",{class:"token string"},"'/login'"),t(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),t(`
  `),n("span",{class:"token punctuation"},"}"),t(`
`),n("span",{class:"token punctuation"},"}")])],-1),B=n("p",null,"By default, redirect occurs with a status response code of 302, but we can pass this status code as the second optional parameter when calling the function, like this:",-1),H=n("pre",{class:"doc-code"},[n("code",null,[n("span",{class:"token function"},"redirect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),t(),n("span",{class:"token literal-property property"},"path"),n("span",{class:"token operator"},":"),t(),n("span",{class:"token string"},"'/moved-permanently'"),t(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),t(),n("span",{class:"token number"},"301"),n("span",{class:"token punctuation"},")")])],-1),U=n("p",null,[t("If "),n("code",{class:"doc-token"},"redirect(false)"),t(" is called (supported only on client-side!), it aborts the current route navigation. Note that if you use it like this in "),n("code",{class:"doc-token"},"src/App.vue"),t(" it will halt the app bootup, which is undesirable.")],-1),D=n("p",null,[t("The "),n("code",{class:"doc-token"},"redirect()"),t(" method requires a Vue Router location Object.")],-1),E=n("p",null,[t("The "),n("code",{class:"doc-token"},"preFetch"),t(" hook runs only once, when the app boots up, so you can use this opportunity to initialize the Pinia store(s) or the Vuex Store here.")],-1),G=n("pre",{class:"doc-code"},[n("code",null,[n("span",{class:"token comment"},"// App.vue - handling Pinia stores"),t(`
`),n("span",{class:"token comment"},'// example with a store named "myStore"'),t(`
`),n("span",{class:"token comment"},"// placed in /src/stores/myStore.js|ts"),t(`

`),n("span",{class:"token keyword"},"import"),t(),n("span",{class:"token punctuation"},"{"),t(" useMyStore "),n("span",{class:"token punctuation"},"}"),t(),n("span",{class:"token keyword"},"from"),t(),n("span",{class:"token string"},"'stores/myStore'"),t(`

`),n("span",{class:"token keyword"},"export"),t(),n("span",{class:"token keyword"},"default"),t(),n("span",{class:"token punctuation"},"{"),t(`
  `),n("span",{class:"token comment"},"// ..."),t(`
  `),n("span",{class:"token function"},"preFetch"),t(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token punctuation"},"{"),t(`
    `),n("span",{class:"token keyword"},"const"),t(" myStore "),n("span",{class:"token operator"},"="),t(),n("span",{class:"token function"},"useMyStore"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),t(`
    `),n("span",{class:"token comment"},"// do something with myStore"),t(`
  `),n("span",{class:"token punctuation"},"}"),t(`
`),n("span",{class:"token punctuation"},"}")])],-1),Y=n("pre",{class:"doc-code"},[n("code",null,[n("span",{class:"token comment"},"// App.vue - handling Pinia stores"),t(`
`),n("span",{class:"token comment"},'// example with a store named "myStore"'),t(`
`),n("span",{class:"token comment"},"// placed in /src/stores/myStore.js|ts"),t(`

`),n("span",{class:"token keyword"},"import"),t(),n("span",{class:"token punctuation"},"{"),t(" useMyStore "),n("span",{class:"token punctuation"},"}"),t(),n("span",{class:"token keyword"},"from"),t(),n("span",{class:"token string"},"'stores/myStore'"),t(`

`),n("span",{class:"token keyword"},"export"),t(),n("span",{class:"token keyword"},"default"),t(),n("span",{class:"token punctuation"},"{"),t(`
  `),n("span",{class:"token comment"},"// ..."),t(`
  `),n("span",{class:"token function"},"preFetch"),t(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[n("span",{class:"token punctuation"},"{"),t(" store "),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token punctuation"},"{"),t(`
    `),n("span",{class:"token keyword"},"const"),t(" myStore "),n("span",{class:"token operator"},"="),t(),n("span",{class:"token function"},"useMyStore"),n("span",{class:"token punctuation"},"("),t("store"),n("span",{class:"token punctuation"},")"),t(`
    `),n("span",{class:"token comment"},"// do something with myStore"),t(`
  `),n("span",{class:"token punctuation"},"}"),t(`
`),n("span",{class:"token punctuation"},"}")])],-1),X=n("pre",{class:"doc-code"},[n("code",null,[n("span",{class:"token comment"},"// App.vue"),t(`

`),n("span",{class:"token keyword"},"export"),t(),n("span",{class:"token keyword"},"default"),t(),n("span",{class:"token punctuation"},"{"),t(`
  `),n("span",{class:"token comment"},"// ..."),t(`
  `),n("span",{class:"token function"},"preFetch"),t(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[n("span",{class:"token punctuation"},"{"),t(" store "),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token punctuation"},"{"),t(`
    `),n("span",{class:"token comment"},"// initialize something in store here"),t(`
  `),n("span",{class:"token punctuation"},"}"),t(`
`),n("span",{class:"token punctuation"},"}")])],-1),J=n("p",null,"In a large application, your Vuex store will likely be split into multiple modules. Of course, it is also possible to code-split these modules into corresponding route component chunks. Suppose we have the following store module:",-1),K=n("pre",{class:"doc-code"},[n("code",null,[n("span",{class:"token comment"},"// we've merged everything into one file here;"),t(`
`),n("span",{class:"token comment"},"// an initialized Quasar project splits every component of a Vuex module"),t(`
`),n("span",{class:"token comment"},"// into separate files, but for the sake of the example"),t(`
`),n("span",{class:"token comment"},"// here in the docs, we show this module as a single file"),t(`

`),n("span",{class:"token keyword"},"export"),t(),n("span",{class:"token keyword"},"default"),t(),n("span",{class:"token punctuation"},"{"),t(`
  `),n("span",{class:"token literal-property property"},"namespaced"),n("span",{class:"token operator"},":"),t(),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},","),t(`
  `),n("span",{class:"token comment"},"// IMPORTANT: state must be a function so the module can be"),t(`
  `),n("span",{class:"token comment"},"// instantiated multiple times"),t(`
  `),n("span",{class:"token function-variable function"},"state"),n("span",{class:"token operator"},":"),t(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token operator"},"=>"),t(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),t(`
    `),n("span",{class:"token literal-property property"},"count"),n("span",{class:"token operator"},":"),t(),n("span",{class:"token number"},"0"),t(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),t(`
  `),n("span",{class:"token literal-property property"},"actions"),n("span",{class:"token operator"},":"),t(),n("span",{class:"token punctuation"},"{"),t(`
    `),n("span",{class:"token function-variable function"},"inc"),n("span",{class:"token operator"},":"),t(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[n("span",{class:"token punctuation"},"{"),t(" commit "),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token operator"},"=>"),t(),n("span",{class:"token function"},"commit"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'inc'"),n("span",{class:"token punctuation"},")"),t(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),t(`
  `),n("span",{class:"token literal-property property"},"mutations"),n("span",{class:"token operator"},":"),t(),n("span",{class:"token punctuation"},"{"),t(`
    `),n("span",{class:"token function-variable function"},"inc"),n("span",{class:"token operator"},":"),t(),n("span",{class:"token parameter"},"state"),t(),n("span",{class:"token operator"},"=>"),t(" state"),n("span",{class:"token punctuation"},"."),t("count"),n("span",{class:"token operator"},"++"),t(`
  `),n("span",{class:"token punctuation"},"}"),t(`
`),n("span",{class:"token punctuation"},"}")])],-1),Z=n("p",null,[t("Now, we can use "),n("code",{class:"doc-token"},"store.registerModule()"),t(" to lazy-register this module in a route component’s "),n("code",{class:"doc-token"},"preFetch()"),t(" hook:")],-1),nn=n("pre",{class:"doc-code"},[n("code",null,[n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),t("template")]),n("span",{class:"token punctuation"},">")]),t(`
  `),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),t("div")]),n("span",{class:"token punctuation"},">")]),t("{{ fooCount }}"),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),t("div")]),n("span",{class:"token punctuation"},">")]),t(`
`),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),t("template")]),n("span",{class:"token punctuation"},">")]),t(`

`),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),t("script")]),n("span",{class:"token punctuation"},">")]),n("span",{class:"token script"},[n("span",{class:"token language-javascript"},[t(`
`),n("span",{class:"token keyword"},"import"),t(),n("span",{class:"token punctuation"},"{"),t(" useStore "),n("span",{class:"token punctuation"},"}"),t(),n("span",{class:"token keyword"},"from"),t(),n("span",{class:"token string"},"'vuex'"),t(`
`),n("span",{class:"token keyword"},"import"),t(),n("span",{class:"token punctuation"},"{"),t(" onMounted"),n("span",{class:"token punctuation"},","),t(" onUnmounted "),n("span",{class:"token punctuation"},"}"),t(),n("span",{class:"token keyword"},"from"),t(),n("span",{class:"token string"},"'vue'"),t(`

`),n("span",{class:"token comment"},"// import the module here instead of in `src/store/index.js`"),t(`
`),n("span",{class:"token keyword"},"import"),t(" fooStoreModule "),n("span",{class:"token keyword"},"from"),t(),n("span",{class:"token string"},"'store/foo'"),t(`

`),n("span",{class:"token keyword"},"export"),t(),n("span",{class:"token keyword"},"default"),t(),n("span",{class:"token punctuation"},"{"),t(`
  `),n("span",{class:"token function"},"preFetch"),t(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[n("span",{class:"token punctuation"},"{"),t(" store "),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token punctuation"},"{"),t(`
    store`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"registerModule"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'foo'"),n("span",{class:"token punctuation"},","),t(" fooStoreModule"),n("span",{class:"token punctuation"},")"),t(`
    `),n("span",{class:"token keyword"},"return"),t(" store"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"dispatch"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'foo/inc'"),n("span",{class:"token punctuation"},")"),t(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),t(`

  `),n("span",{class:"token function"},"setup"),t(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token punctuation"},"{"),t(`
    `),n("span",{class:"token keyword"},"const"),t(" $store "),n("span",{class:"token operator"},"="),t(),n("span",{class:"token function"},"useStore"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),t(`

    `),n("span",{class:"token function"},"onMounted"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token operator"},"=>"),t(),n("span",{class:"token punctuation"},"{"),t(`
      `),n("span",{class:"token comment"},"// Preserve the previous state if it was injected from the server"),t(`
      $store`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"registerModule"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'foo'"),n("span",{class:"token punctuation"},","),t(" fooStoreModule"),n("span",{class:"token punctuation"},","),t(),n("span",{class:"token punctuation"},"{"),t(),n("span",{class:"token literal-property property"},"preserveState"),n("span",{class:"token operator"},":"),t(),n("span",{class:"token boolean"},"true"),t(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),t(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),t(`

    `),n("span",{class:"token function"},"onUnmounted"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token operator"},"=>"),t(),n("span",{class:"token punctuation"},"{"),t(`
      `),n("span",{class:"token comment"},"// IMPORTANT: avoid duplicate module registration on the client"),t(`
      `),n("span",{class:"token comment"},"// when the route is visited multiple times."),t(`
      $store`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"unregisterModule"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'foo'"),n("span",{class:"token punctuation"},")"),t(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),t(`

    `),n("span",{class:"token keyword"},"const"),t(" fooCount "),n("span",{class:"token operator"},"="),t(),n("span",{class:"token function"},"computed"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token operator"},"=>"),t(),n("span",{class:"token punctuation"},"{"),t(`
      `),n("span",{class:"token keyword"},"return"),t(" $store"),n("span",{class:"token punctuation"},"."),t("state"),n("span",{class:"token punctuation"},"."),t("foo"),n("span",{class:"token punctuation"},"."),t(`count
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),t(`

    `),n("span",{class:"token keyword"},"return"),t(),n("span",{class:"token punctuation"},"{"),t(`
      fooCount
    `),n("span",{class:"token punctuation"},"}"),t(`
  `),n("span",{class:"token punctuation"},"}"),t(`
`),n("span",{class:"token punctuation"},"}"),t(`
`)])]),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),t("script")]),n("span",{class:"token punctuation"},">")])])],-1),tn=n("p",null,"Also note that because the module is now a dependency of the route component, it will be moved into the route component’s async chunk by Webpack.",-1),sn=n("div",{class:"doc-note doc-note--warning"},[n("p",{class:"doc-note__title"},"WARNING"),n("p",null,[t("Don’t forget to use the "),n("code",{class:"doc-token"},"preserveState: true"),t(" option for "),n("code",{class:"doc-token"},"registerModule"),t(" so we keep the state injected by the server.")])],-1),an=n("p",null,[t("You can use "),n("code",{class:"doc-token"},"preFetch"),t(" helper to type-hint the store parameter (which will otherwise have an "),n("code",{class:"doc-token"},"any"),t(" type):")],-1),en=n("pre",{class:"doc-code"},[n("code",null,[n("span",{class:"token keyword"},"import"),t(),n("span",{class:"token punctuation"},"{"),t(" preFetch "),n("span",{class:"token punctuation"},"}"),t(),n("span",{class:"token keyword"},"from"),t(),n("span",{class:"token string"},"'quasar/wrappers'"),t(`
`),n("span",{class:"token keyword"},"import"),t(),n("span",{class:"token punctuation"},"{"),t(" Store "),n("span",{class:"token punctuation"},"}"),t(),n("span",{class:"token keyword"},"from"),t(),n("span",{class:"token string"},"'vuex'"),t(`

`),n("span",{class:"token keyword"},"interface"),t(),n("span",{class:"token class-name"},"StateInterface"),t(),n("span",{class:"token punctuation"},"{"),t(`
  `),n("span",{class:"token comment"},"// ..."),t(`
`),n("span",{class:"token punctuation"},"}"),t(`

`),n("span",{class:"token keyword"},"export"),t(),n("span",{class:"token keyword"},"default"),t(),n("span",{class:"token punctuation"},"{"),t(`
  `),n("span",{class:"token literal-property property"},"preFetch"),n("span",{class:"token operator"},":"),t(" preFetch"),n("span",{class:"token operator"},"<"),t("StateInterface"),n("span",{class:"token operator"},">"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[n("span",{class:"token punctuation"},"{"),t(" store "),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token operator"},"=>"),t(),n("span",{class:"token punctuation"},"{"),t(`
    `),n("span",{class:"token comment"},"// Do something with your newly-typed store parameter"),t(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),t(`
`),n("span",{class:"token punctuation"},"}")])],-1),on=n("div",{class:"doc-note doc-note--tip"},[n("p",{class:"doc-note__title"},"TIP"),n("p",null,[t("This is useful only to type "),n("code",{class:"doc-token"},"store"),t(" parameter, other parameters are automatically typed even when using the normal syntax.")])],-1),cn=n("p",null,"A good UX includes notifying the user that something is being worked on in the background while he/she waits for the page to be ready. Quasar CLI offers two options for this out of the box.",-1),pn=n("pre",{class:"doc-code"},[n("code",null,[n("span",{class:"token keyword"},"import"),t(),n("span",{class:"token punctuation"},"{"),t(" Loading "),n("span",{class:"token punctuation"},"}"),t(),n("span",{class:"token keyword"},"from"),t(),n("span",{class:"token string"},"'quasar'"),t(`

`),n("span",{class:"token keyword"},"export"),t(),n("span",{class:"token keyword"},"default"),t(),n("span",{class:"token punctuation"},"{"),t(`
  `),n("span",{class:"token comment"},"// ..."),t(`
  `),n("span",{class:"token function"},"preFetch"),t(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),t(),n("span",{class:"token comment"},"/* ... */"),t(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token punctuation"},"{"),t(`
    Loading`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"show"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),t(`

    `),n("span",{class:"token keyword"},"return"),t(),n("span",{class:"token keyword"},"new"),t(),n("span",{class:"token class-name"},"Promise"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"resolve"),t(),n("span",{class:"token operator"},"=>"),t(),n("span",{class:"token punctuation"},"{"),t(`
      `),n("span",{class:"token comment"},"// do something async here"),t(`
      `),n("span",{class:"token comment"},'// then call "resolve()"'),t(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"then"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token operator"},"=>"),t(),n("span",{class:"token punctuation"},"{"),t(`
      Loading`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"hide"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),t(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),t(`
  `),n("span",{class:"token punctuation"},"}"),t(`
`),n("span",{class:"token punctuation"},"}")])],-1),ln={__name:"prefetch-feature",setup(un){const k=[{name:"The quasar.config file",category:"Quasar CLI (with Webpack)",path:"/quasar-cli-webpack/quasar-config-file"}],d=[{id:"installation",title:"2. Installation"},{id:"how-prefetch-helps-ssr-mode",title:"3. How PreFetch Helps SSR Mode"},{id:"when-prefetch-gets-activated",title:"4. When PreFetch Gets Activated"},{id:"usage",title:"5. Usage"},{id:"redirecting-example",title:"5.1. Redirecting Example",sub:!0},{id:"using-prefetch-to-initialize-pinia-or-vuex-store-s-",title:"5.2. Using preFetch to Initialize Pinia or Vuex Store(s)",sub:!0},{id:"vuex-store-code-splitting",title:"5.3. Vuex Store Code Splitting",sub:!0},{id:"usage-with-vuex-and-typescript",title:"5.4. Usage with Vuex and TypeScript",sub:!0},{id:"loading-state",title:"6. Loading State"},{id:"loadingbar",title:"6.1. LoadingBar",sub:!0},{id:"loading",title:"6.2. Loading",sub:!0}];return(rn,e)=>(h(),m(g,{title:"PreFetch Feature",desc:"(@quasar/app-webpack) How to prefetch data and initialize your Vuex store, validate the route and redirect to another page in a Quasar app.",overline:"Quasar CLI with Webpack - @quasar/app-webpack",heading:"","edit-link":"quasar-cli-webpack/prefetch-feature",toc:d,related:k},{default:o(()=>[w,v,_,b,n("h2",{id:"installation",class:"doc-heading doc-h2",onClick:e[0]||(e[0]=u=>a(l)("installation"))},"Installation"),s(a(p),{title:"/quasar.config file"},{default:o(()=>[S,s(c)]),_:1}),x,n("h2",{id:"how-prefetch-helps-ssr-mode",class:"doc-heading doc-h2",onClick:e[1]||(e[1]=u=>a(l)("how-prefetch-helps-ssr-mode"))},"How PreFetch Helps SSR Mode"),P,F,C,n("h2",{id:"when-prefetch-gets-activated",class:"doc-heading doc-h2",onClick:e[2]||(e[2]=u=>a(l)("when-prefetch-gets-activated"))},"When PreFetch Gets Activated"),L,I,s(a(p),{title:"Routes"},{default:o(()=>[R,s(c)]),_:1}),T,s(f,{class:"doc-page-table","wrap-cells":!0,flat:!0,bordered:!0},{default:o(()=>[A,N]),_:1}),n("h2",{id:"usage",class:"doc-heading doc-h2",onClick:e[3]||(e[3]=u=>a(l)("usage"))},"Usage"),j,s(a(p),{title:"Some .vue component used as route"},{default:o(()=>[M,s(c)]),_:1}),V,s(a(p),null,{default:o(()=>[$,s(c)]),_:1}),n("div",q,[Q,n("p",null,[t("If you are developing a SSR app, then you can check out the "),s(i,{to:"/quasar-cli-webpack/developing-ssr/ssr-context"},{default:o(()=>[t("ssrContext")]),_:1}),t(" Object that gets supplied server-side.")])]),s(a(p),null,{default:o(()=>[O,s(c)]),_:1}),n("h3",{id:"redirecting-example",class:"doc-heading doc-h3",onClick:e[4]||(e[4]=u=>a(l)("redirecting-example"))},"Redirecting Example"),z,s(a(p),null,{default:o(()=>[W,s(c)]),_:1}),B,s(a(p),null,{default:o(()=>[H,s(c)]),_:1}),U,D,n("h3",{id:"using-prefetch-to-initialize-pinia-or-vuex-store-s-",class:"doc-heading doc-h3",onClick:e[5]||(e[5]=u=>a(l)("using-prefetch-to-initialize-pinia-or-vuex-store-s-"))},"Using preFetch to Initialize Pinia or Vuex Store(s)"),E,s(a(p),{tabs:["Pinia on Non SSR","Pinia on SSR"]},{default:o(()=>[s(r,{class:"q-pa-none",name:"Pinia on Non SSR"},{default:o(()=>[G,s(c)]),_:1}),s(r,{class:"q-pa-none",name:"Pinia on SSR"},{default:o(()=>[Y,s(c)]),_:1})]),_:1}),s(a(p),{title:"Handling Vuex store"},{default:o(()=>[X,s(c)]),_:1}),n("h3",{id:"vuex-store-code-splitting",class:"doc-heading doc-h3",onClick:e[6]||(e[6]=u=>a(l)("vuex-store-code-splitting"))},"Vuex Store Code Splitting"),J,s(a(p),{title:"src/store/foo.js"},{default:o(()=>[K,s(c)]),_:1}),Z,s(a(p),{title:"Inside a route component"},{default:o(()=>[nn,s(c)]),_:1}),tn,sn,n("h3",{id:"usage-with-vuex-and-typescript",class:"doc-heading doc-h3",onClick:e[7]||(e[7]=u=>a(l)("usage-with-vuex-and-typescript"))},"Usage with Vuex and TypeScript"),an,s(a(p),null,{default:o(()=>[en,s(c)]),_:1}),on,n("h2",{id:"loading-state",class:"doc-heading doc-h2",onClick:e[8]||(e[8]=u=>a(l)("loading-state"))},"Loading State"),cn,n("h3",{id:"loadingbar",class:"doc-heading doc-h3",onClick:e[9]||(e[9]=u=>a(l)("loadingbar"))},"LoadingBar"),n("p",null,[t("When you add Quasar "),s(i,{to:"/quasar-plugins/loading-bar"},{default:o(()=>[t("LoadingBar")]),_:1}),t(" plugin to your app, Quasar CLI will use it while it runs the preFetch hooks by default.")]),n("h3",{id:"loading",class:"doc-heading doc-h3",onClick:e[10]||(e[10]=u=>a(l)("loading"))},"Loading"),n("p",null,[t("There’s also the possibility to use Quasar "),s(i,{to:"/quasar-plugins/loading"},{default:o(()=>[t("Loading")]),_:1}),t(" plugin. Here’s an example:")]),s(a(p),{title:"A route .vue component"},{default:o(()=>[pn,s(c)]),_:1})]),_:1}))}},yn=y(ln,[["__file","prefetch-feature.md"]]);export{yn as default};
